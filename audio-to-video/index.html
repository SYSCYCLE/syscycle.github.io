<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ses -> Video (GitHub Pages Uyumlu)</title>
    <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.10.1/dist/ffmpeg.min.js"></script>
    <style>
        body { background: #0d1117; color: #c9d1d9; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .box { background: #161b22; padding: 20px; border-radius: 6px; border: 1px solid #30363d; max-width: 600px; width: 100%; text-align: center; }
        h1 { font-size: 1.5rem; margin-bottom: 10px; color: #58a6ff; }
        button { background: #238636; color: white; border: none; padding: 10px 20px; border-radius: 6px; font-weight: bold; cursor: pointer; margin-top: 15px; width: 100%; font-size: 1rem; }
        button:disabled { background: #2ea043; opacity: 0.5; cursor: wait; }
        button:hover:not(:disabled) { background: #2ea043; }
        input { margin: 15px 0; color: #c9d1d9; }
        #log { margin-top: 15px; font-family: monospace; font-size: 0.75rem; color: #7ee787; white-space: pre-wrap; height: 150px; overflow-y: scroll; background: #0d1117; padding: 10px; text-align: left; border: 1px solid #30363d; border-radius: 6px; }
        video { margin-top: 20px; max-width: 100%; border-radius: 6px; border: 1px solid #30363d; }
        a.download-btn { display: block; margin-top: 15px; background: #1f6feb; color: white; padding: 10px; text-decoration: none; border-radius: 6px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="box">
        <h1>üéµ GitHub Pages Converter</h1>
        <p>Ses dosyasƒ±nƒ± se√ß, siyah ekranlƒ± videoya √ßevir.</p>

        <input type="file" id="uploader" accept="audio/*">
        <br>
        <button id="convertBtn" onclick="convertToVideo()">Vƒ∞DEO OLU≈ûTUR</button>

        <div id="log">Sistem ba≈ülatƒ±lƒ±yor...</div>
        
        <video id="outputVideo" controls></video>
        <a id="downloadLink" class="download-btn" style="display:none;">üì• Videoyu ƒ∞ndir</a>
    </div>

    <script>
        const { createFFmpeg, fetchFile } = FFmpeg;
        
        const ffmpeg = createFFmpeg({ 
            log: true,
            corePath: 'https://unpkg.com/@ffmpeg/core@0.10.0/dist/ffmpeg-core.js'
        });

        const logDiv = document.getElementById('log');
        const convertBtn = document.getElementById('convertBtn');

        function log(message) {
            logDiv.innerHTML += message + "\n";
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        async function loadFFmpeg() {
            try {
                log("FFmpeg y√ºkleniyor...");
                await ffmpeg.load();
                log("‚úÖ Hazƒ±r! Dosya se√ßebilirsiniz.");
            } catch (e) {
                log("‚ùå HATA: " + e.message);
            }
        }
        
        loadFFmpeg();

        async function convertToVideo() {
            const files = document.getElementById('uploader').files;
            if (files.length === 0) { alert("Dosya se√ßin!"); return; }

            const file = files[0];
            convertBtn.disabled = true;
            convertBtn.innerText = "ƒ∞≈üleniyor (L√ºtfen bekleyin)...";
            
            logDiv.innerHTML = "ƒ∞≈ülem ba≈üladƒ±...\n";

            try {
                ffmpeg.FS('writeFile', 'input.mp3', await fetchFile(file));

                log("Render ba≈üladƒ±. Bu i≈ülem tarayƒ±cƒ±da yapƒ±ldƒ±ƒüƒ± i√ßin biraz s√ºrebilir...");
                
                await ffmpeg.run(
                    '-f', 'lavfi', '-i', 'color=c=black:s=1080x1920:r=30',
                    '-i', 'input.mp3',
                    '-c:v', 'libx264', 
                    '-preset', 'ultrafast',
                    '-tune', 'stillimage',
                    '-c:a', 'aac', 
                    '-b:a', '128k',
                    '-pix_fmt', 'yuv420p', 
                    '-shortest',
                    'output.mp4'
                );

                log("‚úÖ Bitti! Video hazƒ±rlanƒ±yor...");

                const data = ffmpeg.FS('readFile', 'output.mp4');
                const videoUrl = URL.createObjectURL(new Blob([data.buffer], { type: 'video/mp4' }));
                
                const videoEl = document.getElementById('outputVideo');
                videoEl.src = videoUrl;
                
                const dlLink = document.getElementById('downloadLink');
                dlLink.href = videoUrl;
                dlLink.download = "video.mp4";
                dlLink.style.display = "block";

            } catch (error) {
                log("‚ùå HATA: " + error.message);
                console.error(error);
            } finally {
                convertBtn.disabled = false;
                convertBtn.innerText = "Vƒ∞DEO OLU≈ûTUR";
            }
        }
    </script>
</body>
</html>
